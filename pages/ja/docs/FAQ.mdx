---
title: FAQ
description: よくある質問
---

#### 機能制限
- **Q:** EasyExcelはどのような機能をサポートしていますか？サポートしていない機能は何ですか？
- **A:** EasyExcelはExcelファイルの効率的な読み書き操作をサポートしており、CSVフォーマットのサポート（バージョン3.0.0-beta1から）も含まれます。単一ファイルの並行書き込み、画像マクロの読み取りなどはサポートされていません。

#### 書き込み操作の選択
- **Q:** Excel書き込み時、どのような場合に埋め込みモードを選択し、どのような場合に直接書き込みを選択すべきですか？
- **A:** 複雑なフォーマットのエクスポートにはテンプレート埋め込みを推奨します。シンプルなフォーマットの場合は、直接書き込みの方が効率的です。

#### Lombokアノテーション
- **Q:** EasyExcel使用時、エンティティクラスのLombokアノテーションはどのような役割を果たしますか？
- **A:** エンティティクラスでよく使用される`@Getter`、`@Setter`、`@EqualsAndHashCode`などのLombokアノテーションは、getter、setterメソッドやequals/hashCodeメソッドを自動生成するために使用されます。これらの自動生成されたメソッドを使用したくない場合は、手動で実装することができます。

#### フィールドマッピング
- **Q:** 一部のフィールドが正しく読み書きできない問題をどのように解決しますか？
- **A:** エンティティクラスのフィールドがキャメルケースの命名規則に従っていることを確認し、`@Accessors(chain = true)`の使用を避け、代わりに`@Builder`の使用を推奨します。また、読み書きに参加するフィールドに`@ExcelProperty`アノテーションが付けられていることを確認してください。

#### 互換性の問題
- **Q:** EasyExcel使用時に互換性の問題が発生した場合はどうすればよいですか？
- **A:** `NoSuchMethodException`、`ClassNotFoundException`、`NoClassDefFoundError`などの一般的な互換性の問題は、通常jarパッケージの競合によって引き起こされます。プロジェクトの依存関係を確認してクリーンアップし、使用するEasyExcelのバージョンがプロジェクト内の他のライブラリと互換性があることを確認することをお勧めします。

#### 本番環境でのデプロイ
- **Q:** ローカルでは正常に動作するのに、本番環境で問題が発生するのはなぜですか？
- **A:** ほとんどの場合、本番環境に必要なフォントライブラリが不足していることが原因です。フォントライブラリ（`dejavu-sans-fonts`や`fontconfig`など）をインストールするか、メモリ処理モードを有効にすることで解決できます。

#### 並行読み取り
- **Q:** なぜListenerをSpringで管理してはいけないのですか？
- **A:** ListenerをSpringで管理すると、シングルトンになってしまい、ファイルの並行読み取り時にデータの混乱を引き起こす可能性があります。ファイルを読み取るたびに新しいListenerインスタンスを作成する必要があります。

#### パフォーマンス最適化
- **Q:** 10MB以上の大きなファイルに対して、EasyExcelはどのような読み取り戦略を提供していますか？
- **A:** EasyExcelは、デフォルトの大容量ファイル処理戦略に加えて、カスタマイズ可能な高速モードや、高並行処理・超大容量ファイル向けの最適化設定をサポートしています。

#### 書き込みとフォーマット設定
- **Q:** セルのフォーマットはどのように設定しますか？
- **A:** エンティティクラスのプロパティに`@ContentStyle`などのアノテーションを使用して、数値フォーマットや日付フォーマットなどのセルフォーマットを設定できます。

#### エクスポートの問題
- **Q:** エクスポートしたExcelファイルが開けない、または修復が必要というメッセージが表示される場合はどうすればよいですか？
- **A:** これは通常、フロントエンドフレームワークやバックエンドインターセプターがファイルストリームを変更することが原因です。まずローカルでのエクスポートをテストし、バックエンドのロジックに問題がないことを確認してから、フロントエンドやネットワーク関連の問題を調査することをお勧めします。
